model_rt = lmer(RT ~ specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
print(summary(model_rt))
print(Anova(model_rt))
# estimate marginal means
model.emm <- emmeans(model_rt, ~ specificity)
# compute pairwise comparisons
comparison_results <- pairs(model.emm, adjust='tukey')
# add asterisks for significant values
comparison_results.df <- as.data.frame(comparison_results)
comparison_results.df$significance <- cut(comparison_results.df$p.value,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("***", "**", "*", ""))
print(comparison_results.df)
# Back-transform to the response scale
emmeans_result_response_scale <- regrid(model.emm)
summary(emmeans_result_response_scale)
# Obtain the overall EMM for the 'concreteness' factor
emm_concreteness <- emmeans(model.emm, ~ specificity)
summary(emm_concreteness) # there is no interaction so safe to interpret these
# Plot the estimated marginal means
emm_plot <- emmip(model.emm, specificity, CIs = TRUE) +
theme_minimal()
results_dir <- "U:/ownCloud/projects/NocturnalBird/results/behavioural"
# read in all subject logfiles
list_of_logfiles <- list.files(path = 'U:/ownCloud/projects/NocturnalBird/scripts/analysis/behavioural/data',
recursive = TRUE,
pattern = "\\.csv$",
full.names = TRUE)
group_data <- readr::read_csv(list_of_logfiles, id = "file_name")
group_data = select(group_data, participant, block_nr, trial_nr, item_nr, word1, word2, probe, response, RT, hit, composition, specificity) # selecting relevant columns from logfiles
group_data <- subset(group_data, !is.na(group_data$specificity))
group_data <- subset(group_data, !is.na(group_data$probe))
# group_data = group_data[group_data$hit == 1, ] # only analysing reaction times from trials answered correctly
group_data = mutate(group_data,
RT = log10(RT), # log10 transform RT
participant = factor(participant),
item_nr = factor(item_nr),
specificity = factor(specificity))
group_data = as_tibble(group_data)
group_data
accuracy_participant <- group_data %>%
group_by(participant) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_participant)
write.csv(accuracy_participant, file = file.path(results_dir, "accuracy_by_participant.csv"), row.names = FALSE)
accuracy_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_specificity)
write.csv(accuracy_specificity, file = file.path(results_dir, "accuracy_by_specificity.csv"), row.names = FALSE)
fig_acc <- ggplot(accuracy_specificity, aes(x = specificity, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by specificity",
x = "Specificity",
y = "Accuracy"
)
ggsave(filename = file.path(results_dir, sprintf("fig_accuracy_%s.jpg", 'specificity')),
plot = fig_acc, width = 8, height = 6, dpi = 300)
# fit linear mixed models
model = lmer(hit ~ specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
# by-participant and by-item varying intercepts
model_acc = glmer(hit ~ specificity + (1|participant) + (1|item_nr), data=group_data, family='binomial')
print(summary(model_acc))
Anova(model_acc)
# estimate marginal means
model.emm <- emmeans(model_acc, ~ specificity)
# compute pairwise comparisons
comparison_results <- pairs(model.emm, adjust='tukey')
# add asterisks for significant values
comparison_results.df <- as.data.frame(comparison_results)
comparison_results.df$significance <- cut(comparison_results.df$p.value,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("***", "**", "*", ""))
print(comparison_results.df)
group_data = group_data[group_data$hit == 1, ] # only analysing reaction times from trials answered correctly
# make density plot of RT distribution
plot <- group_data %>% ggplot(aes(x = RT, fill = specificity)) +
geom_density(alpha = 0.5) + theme_minimal() +
scale_fill_brewer(palette = 'PuOr')
ggsave(filename = file.path(results_dir, "fig_RT_density.jpg"),
plot = plot, width = 8, height = 6, dpi = 300)
# make summary stats for RT for each condition
summary_RT_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
count = n(),
mean = mean(RT),
sd = sd(RT),
se = sd(RT) / sqrt(n()),
median = median(RT),
min = min(RT),
max = max(RT)
)
plot <- ggplot(summary_RT_specificity, aes(x = factor(specificity), y = mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2) +
theme_minimal() +
labs(
title = "Mean Reaction Time by specificity",
x = "Specificity",
y = "Mean Reaction Time (s)"
)
ggsave(filename = file.path(results_dir, sprintf("fig_RT_%s.jpg", 'specificity')),
plot = plot, width = 8, height = 6, dpi = 300)
write.csv(summary_RT_specificity, file = file.path(results_dir, "summary_stats_RT_specificity.csv"), row.names = FALSE)
# fit linear mixed models
# by-participant and by-item varying intercepts
model_rt = lmer(RT ~ specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
print(summary(model_rt))
print(Anova(model_rt))
# estimate marginal means
model.emm <- emmeans(model_rt, ~ specificity)
# compute pairwise comparisons
comparison_results <- pairs(model.emm, adjust='tukey')
# add asterisks for significant values
comparison_results.df <- as.data.frame(comparison_results)
comparison_results.df$significance <- cut(comparison_results.df$p.value,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("***", "**", "*", ""))
print(comparison_results.df)
print(summary_RT_specificity)
# make summary stats for RT for each condition
summary_RT_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
count = n(),
mean = mean(RT),
sd = sd(RT),
se = sd(RT) / sqrt(n()),
median = median(RT),
min = min(RT),
max = max(RT)
)
print(summary_RT_specificity)
results_dir <- "U:/ownCloud/projects/NocturnalBird/results/behavioural"
# read in all subject logfiles
list_of_logfiles <- list.files(path = 'U:/ownCloud/projects/NocturnalBird/scripts/analysis/behavioural/data',
recursive = TRUE,
pattern = "\\.csv$",
full.names = TRUE)
group_data <- readr::read_csv(list_of_logfiles, id = "file_name")
group_data = select(group_data, participant, block_nr, trial_nr, item_nr, word1, word2, probe, response, RT, hit, composition, specificity) # selecting relevant columns from logfiles
group_data <- subset(group_data, !is.na(group_data$specificity))
group_data <- subset(group_data, !is.na(group_data$probe))
# group_data = group_data[group_data$hit == 1, ] # only analysing reaction times from trials answered correctly
group_data = mutate(group_data,
# RT = log10(RT), # log10 transform RT
participant = factor(participant),
item_nr = factor(item_nr),
specificity = factor(specificity))
group_data = as_tibble(group_data)
group_data
accuracy_participant <- group_data %>%
group_by(participant) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_participant)
write.csv(accuracy_participant, file = file.path(results_dir, "accuracy_by_participant.csv"), row.names = FALSE)
accuracy_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_specificity)
write.csv(accuracy_specificity, file = file.path(results_dir, "accuracy_by_specificity.csv"), row.names = FALSE)
fig_acc <- ggplot(accuracy_specificity, aes(x = specificity, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by specificity",
x = "Specificity",
y = "Accuracy"
)
ggsave(filename = file.path(results_dir, sprintf("fig_accuracy_%s.jpg", 'specificity')),
plot = fig_acc, width = 8, height = 6, dpi = 300)
group_data = group_data[group_data$hit == 1, ] # only analysing reaction times from trials answered correctly
# make density plot of RT distribution
plot <- group_data %>% ggplot(aes(x = RT, fill = specificity)) +
geom_density(alpha = 0.5) + theme_minimal() +
scale_fill_brewer(palette = 'PuOr')
ggsave(filename = file.path(results_dir, "fig_RT_density.jpg"),
plot = plot, width = 8, height = 6, dpi = 300)
# make summary stats for RT for each condition
summary_RT_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
count = n(),
mean = mean(RT),
sd = sd(RT),
se = sd(RT) / sqrt(n()),
median = median(RT),
min = min(RT),
max = max(RT)
)
print(summary_RT_specificity)
plot <- ggplot(summary_RT_specificity, aes(x = factor(specificity), y = mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2) +
theme_minimal() +
labs(
title = "Mean Reaction Time by specificity",
x = "Specificity",
y = "Mean Reaction Time (s)"
)
ggsave(filename = file.path(results_dir, sprintf("fig_RT_%s.jpg", 'specificity')),
plot = plot, width = 8, height = 6, dpi = 300)
write.csv(summary_RT_specificity, file = file.path(results_dir, "summary_stats_RT_specificity.csv"), row.names = FALSE)
accuracy_participant <- group_data %>%
group_by(participant) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_participant)
write.csv(accuracy_participant, file = file.path(results_dir, "accuracy_by_participant.csv"), row.names = FALSE)
accuracy_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_specificity)
write.csv(accuracy_specificity, file = file.path(results_dir, "accuracy_by_specificity.csv"), row.names = FALSE)
fig_acc <- ggplot(accuracy_specificity, aes(x = specificity, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by specificity",
x = "Specificity",
y = "Accuracy"
)
ggsave(filename = file.path(results_dir, sprintf("fig_accuracy_%s.jpg", 'specificity')),
plot = fig_acc, width = 8, height = 6, dpi = 300)
accuracy_participant <- group_data %>%
group_by(participant) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_participant)
write.csv(accuracy_participant, file = file.path(results_dir, "accuracy_by_participant.csv"), row.names = FALSE)
accuracy_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_specificity)
write.csv(accuracy_specificity, file = file.path(results_dir, "accuracy_by_specificity.csv"), row.names = FALSE)
fig_acc <- ggplot(accuracy_specificity, aes(x = specificity, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by specificity",
x = "Specificity",
y = "Accuracy"
)
fig_acc
accuracy_participant <- group_data %>%
group_by(participant) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_participant)
write.csv(accuracy_participant, file = file.path(results_dir, "accuracy_by_participant.csv"), row.names = FALSE)
accuracy_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_specificity)
write.csv(accuracy_specificity, file = file.path(results_dir, "accuracy_by_specificity.csv"), row.names = FALSE)
fig_acc <- ggplot(accuracy_specificity, aes(x = specificity, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by specificity",
x = "Specificity",
y = "Accuracy"
)
fig_acc
ggsave(filename = file.path(results_dir, sprintf("fig_accuracy_%s.jpg", 'specificity')),
plot = fig_acc, width = 8, height = 6, dpi = 300)
# fit linear mixed models
# by-participant and by-item varying intercepts
model_rt = lmer(RT ~ specificity + (specificity|participant) + (1|item_nr), data=group_data, REML=TRUE)
# fit linear mixed models
# by-participant and by-item varying intercepts
model_rt = lmer(RT ~ specificity + (specificity|participant) + (1|item_nr), data=group_data, REML=TRUE)
print(summary(model_rt))
print(Anova(model_rt))
# estimate marginal means
model.emm <- emmeans(model_rt, ~ specificity)
# compute pairwise comparisons
comparison_results <- pairs(model.emm, adjust='tukey')
# add asterisks for significant values
comparison_results.df <- as.data.frame(comparison_results)
comparison_results.df$significance <- cut(comparison_results.df$p.value,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("***", "**", "*", ""))
print(comparison_results.df)
# fit linear mixed models
# by-participant and by-item varying intercepts
model_rt = lmer(RT ~ specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
print(summary(model_rt))
print(Anova(model_rt))
# estimate marginal means
model.emm <- emmeans(model_rt, ~ specificity)
# compute pairwise comparisons
comparison_results <- pairs(model.emm, adjust='tukey')
# add asterisks for significant values
comparison_results.df <- as.data.frame(comparison_results)
comparison_results.df$significance <- cut(comparison_results.df$p.value,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("***", "**", "*", ""))
print(comparison_results.df)
group_data <- readr::read_csv(list_of_logfiles, id = "file_name")
View(group_data)
results_dir <- "U:/ownCloud/projects/NocturnalBird/results/behavioural"
# read in all subject logfiles
list_of_logfiles <- list.files(path = 'U:/ownCloud/projects/NocturnalBird/scripts/analysis/behavioural/data',
recursive = TRUE,
pattern = "\\.csv$",
full.names = TRUE)
group_data <- readr::read_csv(list_of_logfiles, id = "file_name")
group_data = select(group_data, participant, block_nr, trial_nr, item_nr, word1, word2, probe, response, RT, hit, composition, specificity, zipf_noun) # selecting relevant columns from logfiles
group_data <- subset(group_data, !is.na(group_data$specificity))
group_data <- subset(group_data, !is.na(group_data$probe))
# group_data = group_data[group_data$hit == 1, ] # only analysing reaction times from trials answered correctly
group_data = mutate(group_data,
# RT = log10(RT), # log10 transform RT
participant = factor(participant),
item_nr = factor(item_nr),
specificity = factor(specificity))
group_data = as_tibble(group_data)
group_data
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(lme4)
library(lmerTest)
library(emmeans)
library(car)
library(effects)
results_dir <- "U:/ownCloud/projects/NocturnalBird/results/behavioural"
# read in all subject logfiles
list_of_logfiles <- list.files(path = 'U:/ownCloud/projects/NocturnalBird/scripts/analysis/behavioural/data',
recursive = TRUE,
pattern = "\\.csv$",
full.names = TRUE)
group_data <- readr::read_csv(list_of_logfiles, id = "file_name")
group_data = select(group_data, participant, block_nr, trial_nr, item_nr, word1, word2, probe, response, RT, hit, composition, specificity, zipf_noun) # selecting relevant columns from logfiles
group_data <- subset(group_data, !is.na(group_data$specificity))
group_data <- subset(group_data, !is.na(group_data$probe))
# group_data = group_data[group_data$hit == 1, ] # only analysing reaction times from trials answered correctly
group_data = mutate(group_data,
RT = log10(RT), # log10-transform RT
participant = factor(participant),
item_nr = factor(item_nr),
specificity = factor(specificity))
group_data = as_tibble(group_data)
group_data
accuracy_participant <- group_data %>%
group_by(participant) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_participant)
write.csv(accuracy_participant, file = file.path(results_dir, "accuracy_by_participant.csv"), row.names = FALSE)
accuracy_specificity <- group_data %>%
group_by(specificity) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(accuracy_specificity)
write.csv(accuracy_specificity, file = file.path(results_dir, "accuracy_by_specificity.csv"), row.names = FALSE)
fig_acc <- ggplot(accuracy_specificity, aes(x = specificity, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by specificity",
x = "Specificity",
y = "Accuracy"
)
fig_acc
ggsave(filename = file.path(results_dir, sprintf("fig_accuracy_%s.jpg", 'specificity')),
plot = fig_acc, width = 8, height = 6, dpi = 300)
# by-participant and by-item varying intercepts
model_acc = glmer(hit ~ specificity + (1|participant) + (1|item_nr), data=group_data, family='binomial', REML=TRUE)
# linear mixed model with by-participant and by-item varying intercepts
model_acc.base = glmer(hit ~ zipf_noun + (1|participant) + (1|item_nr), data=group_data, family='binomial')
model_acc.full = glmer(hit ~ zipf_noun + specificity + (1|participant) + (1|item_nr), data=group_data, family='binomial')
print(summary(model_acc.base))
# linear mixed model with by-participant and by-item varying intercepts
model_acc.base = glmer(hit ~ zipf_noun + (1|participant) + (1|item_nr), data=group_data, family='binomial')
model_acc.full = glmer(hit ~ zipf_noun + specificity + (1|participant) + (1|item_nr), data=group_data, family='binomial')
print(summary(model_acc.base))
print(summary(model_acc.full))
Anova(model_acc)
model_acc.full = glmer(hit ~ zipf_noun * specificity + (1|participant) + (1|item_nr), data=group_data, family='binomial')
model_acc.full = glmer(hit ~ zipf_noun + specificity + (1|participant) + (1|item_nr), data=group_data, family='binomial')
anova(model_acc.base, model_acc.full)
# fit linear mixed models
# by-participant and by-item varying intercepts
model_rt.base = lmer(RT ~ specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
model_rt.full = lmer(RT ~ zipf_noun + specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
print(summary(model_rt.base))
print(summary(model_rt.full))
print(anova(model_rt.base, model_rt.full))
# estimate marginal means
model.emm <- emmeans(model_rt, ~ specificity)
# fit linear mixed models
# by-participant and by-item varying intercepts
model_rt.base = lmer(RT ~ specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
model_rt.full = lmer(RT ~ zipf_noun + specificity + (1|participant) + (1|item_nr), data=group_data, REML=TRUE)
print(summary(model_rt.base))
print(summary(model_rt.full))
print(anova(model_rt.base, model_rt.full))
# # estimate marginal means
# model.emm <- emmeans(model_rt, ~ specificity)
#
# # compute pairwise comparisons
# comparison_results <- pairs(model.emm, adjust='tukey')
# # add asterisks for significant values
# comparison_results.df <- as.data.frame(comparison_results)
# comparison_results.df$significance <- cut(comparison_results.df$p.value,
#                                     breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
#                                     labels = c("***", "**", "*", ""))
# print(comparison_results.df)
# get accuracy by participant
acc.ptp <- group_data %>%
group_by(participant) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(acc.ptp)
# write.csv(acc.ptp, file = file.path(results_dir, "accuracy_by_participant.csv"), row.names = FALSE)
fig_acc.ptp <- ggplot(acc.ptp, aes(x = participant, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by participant",
x = "Participant",
y = "Accuracy"
)
fig_acc.ptp
ggsave(filename = file.path(results_dir, "fig_accuracy_by_participant.jpg"),
plot = fig_acc.ptp, width = 8, height = 6, dpi = 300)
# get accuracy by specificity
acc.spec <- group_data %>%
group_by(specificity) %>%
summarise(
total_trials = n(),
correct_trials = sum(hit),
accuracy = mean(hit)
)
print(acc.spec)
# write.csv(acc.spec, file = file.path(results_dir, "accuracy_by_specificity.csv"), row.names = FALSE)
fig_acc <- ggplot(acc.spec, aes(x = specificity, y = accuracy)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "red", fill = "red") +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, color = "red") +
theme_minimal() +
labs(
title = "Accuracy by specificity",
x = "Specificity",
y = "Accuracy"
)
fig_acc.spec
